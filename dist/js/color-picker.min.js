// ColorPicker v0.0.1alpha2 | thednp © 2022 | MIT-License
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ColorPicker=t()}(this,(function(){"use strict";const e={};function t(t){const o=this,{type:r}=t;(e[r]?[...e[r]]:[]).forEach(e=>{const[a,i]=e;[...i].forEach(e=>{if(a===o){const[o,i]=e;o.apply(a,[t]),i&&i.once&&n(a,r,o,i)}})})}const o=(o,n,r,a)=>{e[n]||(e[n]=new Map);const i=e[n];i.has(o)||i.set(o,new Map);const s=i.get(o),{size:l}=s;s&&s.set(r,a),l||o.addEventListener(n,t,a)},n=(o,n,r,a)=>{const i=e[n],s=i&&i.get(o),l=s&&s.get(r),{options:c}=void 0!==l?l:{options:a};s&&s.has(r)&&s.delete(r),!i||s&&s.size||i.delete(o),i&&i.size||delete e[n],s&&s.size||o.removeEventListener(n,t,c)},r="ArrowDown",a="ArrowUp",i="ArrowLeft",s="ArrowRight",l="Enter",c="Space";function h(e){return e instanceof HTMLElement?e.ownerDocument:e instanceof Window?e.document:window.document}const{userAgentData:u}=navigator,d=u,{userAgent:g}=navigator,p=g,b=/iPhone|iPad|iPod|Android/i;let m=!1;m=d?d.brands.some(e=>b.test(e.brand)):b.test(p);const f=m;let w=0,v=0;const x=new Map;function y(e,t){const{width:o,height:n,top:r,right:a,bottom:i,left:s}=e.getBoundingClientRect();let l=1,c=1;if(t&&e instanceof HTMLElement){const{offsetWidth:t,offsetHeight:r}=e;l=t>0&&Math.round(o)/t||1,c=r>0&&Math.round(n)/r||1}return{width:o/l,height:n/c,top:r/c,right:a/l,bottom:i/c,left:s/l,x:s/l,y:r/c}}function k(e,t){const o=getComputedStyle(e);return t in o?o[t]:""}const S=[Document,Element,HTMLElement],C=[Element,HTMLElement];function M(e,t){const o=S.some(e=>t instanceof e)?t:h();return C.some(t=>e instanceof t)?e:o.querySelector(e)}function $(e,t){return(t&&S.some(e=>t instanceof e)?t:h()).querySelectorAll(e)}const L=(e,t)=>Object.assign(e,t);function N(e){if("string"==typeof e)return h().createElement(e);const{tagName:t}=e,o={...e},n=N(t);return delete o.tagName,L(n,o),n}function P(e,t){if("string"==typeof t)return h().createElementNS(e,t);const{tagName:o}=t,n={...t},r=P(e,o);return delete n.tagName,L(r,n),r}const E=new Map,H={set:(e,t,o)=>{const n=M(e);if(!n)return;E.has(t)||E.set(t,new Map);E.get(t).set(n,o)},getAllFor:e=>E.get(e)||null,get:(e,t)=>{const o=M(e),n=H.getAllFor(t);return o&&n&&n.get(o)||null},remove:(e,t)=>{const o=M(e),n=E.get(t);n&&o&&(n.delete(o),0===n.size&&E.delete(t))}},A=(e,t)=>{L(e.style,t)};function R(e,t){return e.classList.contains(t)}function T(e,t){e.classList.add(t)}function F(e,t){e.classList.remove(t)}const D=(e,t,o)=>e.setAttribute(t,o),I=(e,t)=>e.getAttribute(t),O=(e,t)=>e.removeAttribute(t),V={pickerLabel:"Colour Picker",appearanceLabel:"Colour Appearance",valueLabel:"Colour Value",toggleLabel:"Select Colour",menuLabel:"Colour Presets",formatLabel:"Format",alphaLabel:"Alpha",hexLabel:"Hexadecimal",hueLabel:"Hue",saturationLabel:"Saturation",lightnessLabel:"Lightness",redLabel:"Red",greenLabel:"Green",blueLabel:"Blue"},K=["white","black","grey","red","orange","brown","gold","olive","yellow","lime","green","teal","cyan","blue","violet","magenta","pink"],q=["transparent","currentColor","inherit","initial"];const U=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","goldenrod","gold","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavenderblush","lavender","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],G="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",_=`[\\s|\\(]+(${G})[,|\\s]+(${G})[,|\\s]+(${G})\\s*\\)?`,j=`[\\s|\\(]+(${G})[,|\\s]+(${G})[,|\\s]+(${G})[,|\\s]+(${G})\\s*\\)?`,B={CSS_UNIT:new RegExp(G),rgb:new RegExp("rgb"+_),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+_),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+_),hsva:new RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function z(e){return"string"==typeof e&&e.includes(".")&&1===parseFloat(e)}function X(e){return"string"==typeof e&&e.includes("%")}function Y(e){return Boolean(B.CSS_UNIT.exec(String(e)))}function W(e,t){let o=e;return z(e)&&(o="100%"),o=360===t?o:Math.min(t,Math.max(0,parseFloat(o))),X(o)&&(o=parseInt(String(o*t),10)/100),Math.abs(o-t)<1e-6?1:(o=360===t?(o<0?o%t+t:o%t)/parseFloat(String(t)):o%t/parseFloat(String(t)),o)}function J(e){let t=parseFloat(e);return(Number.isNaN(t)||t<0||t>1)&&(t=1),t}function Z(e){return Math.min(1,Math.max(0,e))}function Q(e){const t=h(o).head;var o;A(t,{color:e});const n=k(t,"color");return A(t,{color:""}),n}function ee(e){return e<=1?100*Number(e)+"%":e}function te(e){return 1===e.length?"0"+e:String(e)}function oe(e,t,o){return{r:255*W(e,255),g:255*W(t,255),b:255*W(o,255)}}function ne(e,t,o){const n=W(e,255),r=W(t,255),a=W(o,255),i=Math.max(n,r,a),s=Math.min(n,r,a);let l=0,c=0;const h=(i+s)/2;if(i===s)c=0,l=0;else{const e=i-s;switch(c=h>.5?e/(2-i-s):e/(i+s),i){case n:l=(r-a)/e+(r<a?6:0);break;case r:l=(a-n)/e+2;break;case a:l=(n-r)/e+4}l/=6}return{h:l,s:c,l:h}}function re(e,t,o){let n=o;return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*n*(t-e):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function ae(e,t,o){let n=0,r=0,a=0;const i=W(e,360),s=W(t,100),l=W(o,100);if(0===s)r=l,a=l,n=l;else{const e=l<.5?l*(1+s):l+s-l*s,t=2*l-e;n=re(t,e,i+1/3),r=re(t,e,i),a=re(t,e,i-1/3)}return{r:255*n,g:255*r,b:255*a}}function ie(e,t,o){const n=W(e,255),r=W(t,255),a=W(o,255),i=Math.max(n,r,a),s=Math.min(n,r,a);let l=0;const c=i,h=i-s,u=0===i?0:h/i;if(i===s)l=0;else{switch(i){case n:l=(r-a)/h+(r<a?6:0);break;case r:l=(a-n)/h+2;break;case a:l=(n-r)/h+4}l/=6}return{h:l,s:u,v:c}}function se(e,t,o){const n=6*W(e,360),r=W(t,100),a=W(o,100),i=Math.floor(n),s=n-i,l=a*(1-r),c=a*(1-s*r),h=a*(1-(1-s)*r),u=i%6;return{r:255*[a,c,l,l,h,a][u],g:255*[h,a,a,c,l,l][u],b:255*[l,l,h,a,a,c][u]}}function le(e,t,o){return[te(Math.round(e).toString(16)),te(Math.round(t).toString(16)),te(Math.round(o).toString(16))].join("")}function ce(e){return he(e)/255}function he(e){return parseInt(e,16)}function ue(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}function de(e){let t=e.trim().toLowerCase();if(0===t.length)return{r:0,g:0,b:0,a:0};let o=!1;if(U.includes(t))t=Q(t),o=!0;else if(q.includes(t))return{r:255,g:255,b:255,a:1,format:"rgb"};let n=B.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=B.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=B.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=B.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=B.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=B.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=B.hex8.exec(t),n?{r:he(n[1]),g:he(n[2]),b:he(n[3]),a:ce(n[4]),format:o?"rgb":"hex8"}:(n=B.hex6.exec(t),n?{r:he(n[1]),g:he(n[2]),b:he(n[3]),format:o?"rgb":"hex"}:(n=B.hex4.exec(t),n?{r:he(n[1]+n[1]),g:he(n[2]+n[2]),b:he(n[3]+n[3]),a:ce(n[4]+n[4]),format:o?"rgb":"hex8"}:(n=B.hex3.exec(t),!!n&&{r:he(n[1]+n[1]),g:he(n[2]+n[2]),b:he(n[3]+n[3]),format:o?"rgb":"hex"})))))))))}function ge(e){let t,o={r:0,g:0,b:0},n=e,r=null,a=null,i=null,s=!1,l="hex";return"string"==typeof e&&(n=de(e),n&&(s=!0)),"object"==typeof n&&(Y(n.r)&&Y(n.g)&&Y(n.b)?(o=oe(n.r,n.g,n.b),s=!0,l="%"===(""+n.r).slice(-1)?"prgb":"rgb"):Y(n.h)&&Y(n.s)&&Y(n.v)?(r=ee(n.s),a=ee(n.v),o=se(n.h,r,a),s=!0,l="hsv"):Y(n.h)&&Y(n.s)&&Y(n.l)&&(r=ee(n.s),i=ee(n.l),o=ae(n.h,r,i),s=!0,l="hsl"),"a"in n&&(t=n.a)),{ok:s,format:n.format||l,r:Math.min(255,Math.max(o.r,0)),g:Math.min(255,Math.max(o.g,0)),b:Math.min(255,Math.max(o.b,0)),a:J(t)}}class pe{constructor(e,t){let o=e;const n=t&&["hex","rgb","hsl"].includes(t)?t:"hex";o instanceof pe&&(o=ge(o)),"number"==typeof o&&(o=ue(o));const{r:r,g:a,b:i,a:s,ok:l,format:c}=ge(o);this.originalInput=o,this.r=r,this.g=a,this.b=i,this.a=s,this.ok=l,this.roundA=Math.round(100*this.a)/100,this.format=n||c,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b))}get isValid(){return this.ok}get isDark(){return this.brightness<128}get luminance(){const{r:e,g:t,b:o}=this;let n=0,r=0,a=0;const i=e/255,s=t/255,l=o/255;return n=i<=.03928?i/12.92:((i+.055)/1.055)**2.4,r=s<=.03928?s/12.92:((s+.055)/1.055)**2.4,a=l<=.03928?l/12.92:((l+.055)/1.055)**2.4,.2126*n+.7152*r+.0722*a}get brightness(){const{r:e,g:t,b:o}=this;return(299*e+587*t+114*o)/1e3}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbString(){const e=Math.round(this.r),t=Math.round(this.g),o=Math.round(this.b);return 1===this.a?`rgb(${e},${t},${o})`:`rgba(${e},${t},${o},${this.roundA})`}toHex(){return le(this.r,this.g,this.b)}toHexString(){return"#"+this.toHex()}toHsv(){const{h:e,s:t,v:o}=ie(this.r,this.g,this.b);return{h:360*e,s:t,v:o,a:this.a}}toHsl(){const{h:e,s:t,l:o}=ne(this.r,this.g,this.b);return{h:360*e,s:t,l:o,a:this.a}}toHslString(){let{h:e,s:t,l:o}=this.toHsl();return e=Math.round(e),t=Math.round(100*t),o=Math.round(100*o),1===this.a?`hsl(${e},${t}%,${o}%)`:`hsla(${e},${t}%,${o}%,${this.roundA})`}setAlpha(e){return this.a=J(e),this.roundA=Math.round(100*this.a)/100,this}saturate(e){if(!e)return this;const t=this.toHsl();return t.s+=e/100,t.s=Z(t.s),new pe(t)}desaturate(e){return e?this.saturate(-e):this}greyscale(){return this.desaturate(100)}clone(){return new pe(this)}toString(){const{format:e}=this;return"rgb"===e?this.toRgbString():"hsl"===e?this.toHslString():this.toHexString()}}L(pe,{webColors:U,CSS_INTEGER:"[-\\+]?\\d+%?",CSS_NUMBER:"[-\\+]?\\d*\\.\\d+%?",CSS_UNIT:G,PERMISSIVE_MATCH3:_,PERMISSIVE_MATCH4:j,matchers:B,isOnePointZero:z,isPercentage:X,isValidCSSUnit:Y,bound01:W,boundAlpha:J,clamp01:Z,getHexFromColorName:Q,convertToPercentage:ee,convertHexToDecimal:ce,pad2:te,rgbToRgb:oe,rgbToHsl:ne,rgbToHex:le,rgbToHsv:ie,hslToRgb:ae,hsvToRgb:se,hue2rgb:re,parseIntFromHex:he,numberInputToObject:ue,stringInputToObject:de,inputToRGB:ge});const be=e=>{return t=e,o="color-picker",H.get(t,o);var t,o};function me(e){const{input:t,parent:o,format:n,id:r,componentLabels:a,keywords:i}=e,s=I(t,"value")||"#fff",{toggleLabel:l,menuLabel:c,pickerLabel:h,formatLabel:u,hexLabel:d}=a,g=q.includes(s)?"#fff":s;e.color=new pe(g,n);const p=f?" mobile":"",b="hex"===n?d:n.toUpperCase(),m=N({id:"picker-btn-"+r,tagName:"button",className:"picker-toggle button-appearance"});D(m,"aria-expanded","false"),D(m,"aria-haspopup","true"),m.append(N({tagName:"span",className:"v-hidden",innerText:`${h}. ${u}: ${b}`}));const w=N({tagName:"div",className:"color-dropdown picker"+p});D(w,"aria-labelledby","picker-btn-"+r),D(w,"role","group");const v=function(e){const{format:t,componentLabels:o}=e,{hueLabel:n,alphaLabel:r,lightnessLabel:a,saturationLabel:i}=o,s=f?150:230,l=f?150:230,c="hsl"===t?360:100,h="hsl"===t?100:360,u="hsl"===t?`${n} & ${a}`:`${a} & ${i}`,d="hsl"===t?""+i:""+n,g=N({tagName:"div",className:"color-controls "+t}),p=[{w:s,h:l,i:1,c:"color-pointer",l:u,min:0,max:c},{w:21,h:l,i:2,c:"color-slider",l:d,min:0,max:h}];return"hex"!==t&&p.push({w:21,h:l,i:3,c:"color-slider",l:r,min:0,max:100}),p.forEach(e=>{const{w:t,h:o,i:n,c:r,l:a,min:i,max:s}=e,l=N({tagName:"div",className:"color-control"});D(l,"role","presentation"),l.append(N({tagName:"canvas",className:"visual-control"+n,ariaHidden:"true",width:""+t,height:""+o}));const c=N({tagName:"div",className:r+" knob",ariaLive:"polite"});D(c,"aria-label",a),D(c,"role","slider"),D(c,"tabindex","0"),D(c,"aria-valuemin",""+i),D(c,"aria-valuemax",""+s),l.append(c),g.append(l)}),g}(e),x=function(e){const{format:t,id:o,componentLabels:n}=e,r=N({tagName:"div",className:"color-form "+t});let a=["hex"];return"rgb"===t?a=["red","green","blue","alpha"]:"hsl"===t&&(a=["hue","saturation","lightness","alpha"]),a.forEach(e=>{const[a]="hex"===t?["#"]:(i=e,i.toUpperCase()).split("");var i;const s=`color_${t}_${e}_${o}`,l=n[e+"Label"],c=N({tagName:"label"});D(c,"for",s),c.append(N({tagName:"span",ariaHidden:"true",innerText:a+":"}),N({tagName:"span",className:"v-hidden",innerText:l}));const h=N({tagName:"input",id:s,type:"hex"===t?"text":"number",value:"alpha"===e?"1":"0",className:"color-input "+e,autocomplete:"off",spellcheck:"false"});if("hex"!==t){let o="1",n="0.01";"alpha"!==e&&("rgb"===t?(o="255",n="1"):"hue"===e?(o="360",n="1"):(o="100",n="1")),L(h,{min:"0",max:o,step:n})}r.append(c,h)}),r}(e);if(w.append(v,x),t.before(m),o.append(w),i){const e=i,r=N({tagName:"div",className:"color-dropdown menu"+p}),a=N({tagName:"ul",className:"color-menu"});D(a,"role","listbox"),D(a,"aria-label",""+c),r.append(a),e.forEach(e=>{const o=e.trim(),r=new pe(o,n).toString()===I(t,"value"),i=N({tagName:"li",className:"color-option"+(r?" active":""),innerText:""+e});D(i,"tabindex","0"),D(i,"data-value",""+o),D(i,"role","option"),D(i,"aria-selected",r?"true":"false"),a.append(i)});const s=N({tagName:"button",className:"menu-toggle button-appearance"});D(s,"aria-expanded","false"),D(s,"aria-haspopup","true");const h=encodeURI("http://www.w3.org/2000/svg"),u=P(h,{tagName:"svg"});D(u,"xmlns",h),D(u,"viewBox","0 0 512 512"),D(u,"aria-hidden","true");const d=P(h,{tagName:"path"});D(d,"d","M98,158l157,156L411,158l27,27L255,368L71,185L98,158z"),D(d,"fill","#fff"),u.append(d),s.append(N({tagName:"span",className:"v-hidden",innerText:""+l}),u),o.append(s,r)}i&&q.includes(s)&&(e.value=s),D(t,"tabindex","-1")}function fe(e,t){const r=t?o:n,{input:a,pickerToggle:i,menuToggle:s}=e;r(a,"focusin",e.showPicker),r(i,"click",e.togglePicker),r(a,"keydown",e.keyHandler),s&&r(s,"click",e.toggleMenu)}function we(e,t){const r=t?o:n,{input:a,colorMenu:i,parent:s}=e,l=h(a),c=function(e){if(null==e)return window;if(!(e instanceof Window)){const{ownerDocument:t}=e;return t&&t.defaultView||window}return e}(a),u="ontouchstart"in l?{down:"touchstart",move:"touchmove",up:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup"};r(e.controls,u.down,e.pointerDown),e.controlKnobs.forEach(t=>r(t,"keydown",e.handleKnobs)),r(c,"scroll",e.handleScroll),[a,...e.inputs].forEach(t=>r(t,"change",e.changeHandler)),i&&(r(i,"click",e.menuClickHandler),r(i,"keydown",e.menuKeyHandler)),r(l,u.move,e.pointerMove),r(l,u.up,e.pointerUp),r(s,"focusout",e.handleFocusOut),r(c,"keyup",e.handleDismiss)}function ve(e){var t,o;t=e.input,o=new CustomEvent("colorpicker.change"),t.dispatchEvent(o)}function xe(e){e&&["bottom","top"].forEach(t=>F(e,t))}function ye(e,t){const{colorPicker:o,colorMenu:n,menuToggle:r,pickerToggle:a,parent:i}=e,s=t===o,l=s?n:o,c=s?r:a,h=s?a:r;R(i,"open")||T(i,"open"),F(l,"show"),xe(l),T(t,"bottom"),t.offsetHeight,T(t,"show"),e.show(),D(h,"aria-expanded","true"),D(c,"aria-expanded","false")}class ke{constructor(e){const t=this;if(t.input=M(e),!t.input)throw new TypeError(`ColorPicker target ${e} cannot be found.`);const{input:o}=t,n=be(o);if(n)return n;if(t.parent=function e(t,o){return t?t.closest(o)||e(t.getRootNode().host,o):null}(o,".color-picker,color-picker"),!t.parent)throw new TypeError("ColorPicker requires a specific markup to work.");t.id=function e(t,o){let n=o?w:v;if(o){const r=e(t),a=x.get(r)||new Map;x.has(r)||x.set(r,a),a.has(o)?n=a.get(o):(a.set(o,n),w+=1)}else{const e=t.id||t;x.has(e)?n=x.get(e):(x.set(e,n),v+=1)}return n}(o,"color-picker"),t.dragElement=null,t.isOpen=!1,t.controlPositions={c1x:0,c1y:0,c2y:0,c3y:0},t.colorLabels={},t.keywords=!1,t.color=new pe("white",t.format);const{componentLabels:r,colorLabels:a,keywords:i}=o.dataset,s=a&&17===a.split(",").length?a.split(","):K;K.forEach((e,o)=>{t.colorLabels[e]=s[o].trim()});const l=L({},V),c=r&&function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(r)?JSON.parse(r):{};t.componentLabels=L(l,c),"false"!==i&&(t.keywords=i?i.split(","):q),t.showPicker=t.showPicker.bind(t),t.togglePicker=t.togglePicker.bind(t),t.toggleMenu=t.toggleMenu.bind(t),t.menuClickHandler=t.menuClickHandler.bind(t),t.menuKeyHandler=t.menuKeyHandler.bind(t),t.pointerDown=t.pointerDown.bind(t),t.pointerMove=t.pointerMove.bind(t),t.pointerUp=t.pointerUp.bind(t),t.handleScroll=t.handleScroll.bind(t),t.handleFocusOut=t.handleFocusOut.bind(t),t.changeHandler=t.changeHandler.bind(t),t.handleDismiss=t.handleDismiss.bind(t),t.keyHandler=t.keyHandler.bind(t),t.handleKnobs=t.handleKnobs.bind(t),me(t);const{parent:u}=t,[d,g]=function(e,t){return(t&&S.some(e=>t instanceof e)?t:h()).getElementsByClassName(e)}("color-dropdown",u);t.pickerToggle=M(".picker-toggle",u),t.menuToggle=M(".menu-toggle",u),t.colorPicker=d,t.colorMenu=g,t.controls=M(".color-controls",u),t.inputs=[...$(".color-input",u)],t.controlKnobs=[...$(".knob",u)],t.visuals=[...$("canvas",t.controls)],t.knobLabels=[...$(".color-label",u)];const[p,b,m]=t.visuals;t.width1=p.width,t.height1=p.height,t.width2=b.width,t.height2=b.height,t.ctx1=p.getContext("2d"),t.ctx2=b.getContext("2d"),t.ctx1.rect(0,0,t.width1,t.height1),t.ctx2.rect(0,0,t.width2,t.height2),t.width3=0,t.height3=0,"hex"!==t.format&&(t.width3=m.width,t.height3=m.height,this.ctx3=m.getContext("2d"),t.ctx3.rect(0,0,t.width3,t.height3)),this.setControlPositions(),this.setColorAppearence(),this.updateInputs(!0),this.updateControls(),this.updateVisuals(),fe(t,!0),H.set(o,"color-picker",t)}get value(){return this.input.value}set value(e){this.input.value=e}get format(){return this.input.dataset.format||"rgb"}get includeNonColor(){return this.keywords instanceof Array&&this.keywords.some(e=>q.includes(e))}get isCE(){return"color-picker"===this.parent.tagName}get hex(){return this.color.toHex()}get hsv(){return this.color.toHsv()}get hsl(){return this.color.toHsl()}get rgb(){return this.color.toRgb()}get brightness(){return this.color.brightness}get luminance(){return this.color.luminance}get isDark(){const{rgb:e,brightness:t}=this;return t<120&&e.a>.33}get isValid(){const e=this.input.value;return""!==e&&new pe(e).isValid}updateVisuals(){const{color:e,format:t,controlPositions:o,width1:n,width2:r,width3:a,height1:i,height2:s,height3:l,ctx1:c,ctx2:h,ctx3:u}=this,{r:d,g:g,b:p}=e;if("hsl"!==t){const e=Math.round(o.c2y/s*360);c.fillStyle=new pe(`hsl(${e},100%,50%})`).toRgbString(),c.fillRect(0,0,n,i);const t=h.createLinearGradient(0,0,n,0);t.addColorStop(0,"rgba(255,255,255,1)"),t.addColorStop(1,"rgba(255,255,255,0)"),c.fillStyle=t,c.fillRect(0,0,n,i);const a=h.createLinearGradient(0,0,0,i);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)"),c.fillStyle=a,c.fillRect(0,0,n,i);const l=h.createLinearGradient(0,0,0,i);l.addColorStop(0,"rgba(255,0,0,1)"),l.addColorStop(.17,"rgba(255,255,0,1)"),l.addColorStop(.34,"rgba(0,255,0,1)"),l.addColorStop(.51,"rgba(0,255,255,1)"),l.addColorStop(.68,"rgba(0,0,255,1)"),l.addColorStop(.85,"rgba(255,0,255,1)"),l.addColorStop(1,"rgba(255,0,0,1)"),h.fillStyle=l,h.fillRect(0,0,r,s)}else{const t=c.createLinearGradient(0,0,n,0),r=Math.round(100*(1-o.c2y/s));t.addColorStop(0,new pe("rgba(255,0,0,1)").desaturate(100-r).toRgbString()),t.addColorStop(.17,new pe("rgba(255,255,0,1)").desaturate(100-r).toRgbString()),t.addColorStop(.34,new pe("rgba(0,255,0,1)").desaturate(100-r).toRgbString()),t.addColorStop(.51,new pe("rgba(0,255,255,1)").desaturate(100-r).toRgbString()),t.addColorStop(.68,new pe("rgba(0,0,255,1)").desaturate(100-r).toRgbString()),t.addColorStop(.85,new pe("rgba(255,0,255,1)").desaturate(100-r).toRgbString()),t.addColorStop(1,new pe("rgba(255,0,0,1)").desaturate(100-r).toRgbString()),c.fillStyle=t,c.fillRect(0,0,n,i);const u=c.createLinearGradient(0,0,0,i);u.addColorStop(0,"rgba(255,255,255,1)"),u.addColorStop(.5,"rgba(255,255,255,0)"),c.fillStyle=u,c.fillRect(0,0,n,i);const b=c.createLinearGradient(0,0,0,i);b.addColorStop(.5,"rgba(0,0,0,0)"),b.addColorStop(1,"rgba(0,0,0,1)"),c.fillStyle=b,c.fillRect(0,0,n,i);const m=h.createLinearGradient(0,0,0,s),f=e.clone().greyscale().toRgb();m.addColorStop(0,`rgba(${d},${g},${p},1)`),m.addColorStop(1,`rgba(${f.r},${f.g},${f.b},1)`),h.fillStyle=m,h.fillRect(0,0,a,l)}if("hex"!==t){u.clearRect(0,0,a,l);const e=u.createLinearGradient(0,0,0,l);e.addColorStop(0,`rgba(${d},${g},${p},1)`),e.addColorStop(1,`rgba(${d},${g},${p},0)`),u.fillStyle=e,u.fillRect(0,0,a,l)}}handleFocusOut({relatedTarget:e}){e&&!this.parent.contains(e)&&this.hide(!0)}handleDismiss({code:e}){const t=this;t.isOpen&&"Escape"===e&&t.hide()}handleScroll(e){const{activeElement:t}=document;(f&&this.dragElement||t&&this.controlKnobs.includes(t))&&(e.stopPropagation(),e.preventDefault()),this.updateDropdownPosition()}menuKeyHandler(e){const{target:t,code:o}=e;[r,a].includes(o)?e.preventDefault():[l,c].includes(o)&&this.menuClickHandler({target:t})}menuClickHandler(e){const t=this,{target:o}=e,{format:n}=t,r=(I(o,"data-value")||"").trim(),a=t.colorMenu.querySelector("li.active"),i=q.includes(r)?"white":r;t.color=new pe(i,n),t.setControlPositions(),t.setColorAppearence(),t.updateInputs(!0),t.updateControls(),t.updateVisuals(),a&&(F(a,"active"),O(a,"aria-selected")),a!==o&&(T(o,"active"),D(o,"aria-selected","true"),q.includes(r)&&(t.value=r,ve(t)))}pointerDown(e){const t=this,{type:o,target:n,touches:r,pageX:a,pageY:i}=e,{visuals:s,controlKnobs:l,format:c}=t,[h,u,d]=s,[g,p,b]=l,m="canvas"===n.tagName?n:M("canvas",n.parentElement),f=y(m),w="touchstart"===o?r[0].pageX:a,v="touchstart"===o?r[0].pageY:i,x=w-window.pageXOffset-f.left,k=v-window.pageYOffset-f.top;n===h||n===g?(t.dragElement=m,t.changeControl1(x,k)):n===u||n===p?(t.dragElement=m,t.changeControl2(k)):"hex"===c||n!==d&&n!==b||(t.dragElement=m,t.changeAlpha(k)),e.preventDefault()}pointerUp({target:e}){const t=this,o=document.getSelection();t.dragElement||o.toString().length||t.parent.contains(e)||t.hide(),t.dragElement=null}pointerMove(e){const t=this,{dragElement:o,visuals:n,format:r}=t,[a,i,s]=n,{type:l,touches:c,pageX:h,pageY:u}=e;if(!o)return;const d=y(o),g="touchmove"===l?c[0].pageX:h,p="touchmove"===l?c[0].pageY:u,b=g-window.pageXOffset-d.left,m=p-window.pageYOffset-d.top;o===a&&t.changeControl1(b,m),o===i&&t.changeControl2(m),o===s&&"hex"!==r&&t.changeAlpha(m)}handleKnobs(e){const{target:t,code:o}=e,n=this;if(![a,r,i,s].includes(o))return;e.preventDefault();const{activeElement:l}=document,{controlKnobs:c}=n,h=c.find(e=>e===l),[u,d,g]=c;if(h){let l=0,c=0;t===u?([i,s].includes(o)?n.controlPositions.c1x+=o===s?1:-1:[a,r].includes(o)&&(n.controlPositions.c1y+=o===r?1:-1),l=n.controlPositions.c1x,c=n.controlPositions.c1y,n.changeControl1(l,c)):t===d?(n.controlPositions.c2y+=[r,s].includes(o)?1:-1,c=n.controlPositions.c2y,n.changeControl2(c)):t===g&&(n.controlPositions.c3y+=[r,s].includes(o)?1:-1,c=n.controlPositions.c3y,n.changeAlpha(c)),n.setColorAppearence(),n.updateInputs(),n.updateControls(),n.updateVisuals(),n.handleScroll(e)}}changeHandler(){const e=this;let t;const{activeElement:o}=document,{inputs:n,format:r,value:a,input:i}=e,[s,l,c,h]=n,u=e.includeNonColor&&q.includes(a);(o===i||o&&n.includes(o))&&(t=o===i?u?"white":a:"hex"===r?s.value:"hsl"===r?`hsla(${s.value},${l.value}%,${c.value}%,${h.value})`:`rgba(${n.map(e=>e.value).join(",")})`,e.color=new pe(t,r),e.setControlPositions(),e.setColorAppearence(),e.updateInputs(),e.updateControls(),e.updateVisuals(),o===i&&u&&(e.value=a))}changeControl1(e,t){let[o,n]=[0,0];const{format:r,controlPositions:a,height1:i,height2:s,height3:l,width1:c}=this;e>c?o=c:e>=0&&(o=e),t>i?n=i:t>=0&&(n=t);const h="hsl"!==r?Math.round(a.c2y/s*360):Math.round(o/c*360),u="hsl"!==r?Math.round(o/c*100):Math.round(100*(1-a.c2y/s)),d=Math.round(100*(1-n/i)),g="hex"!==r?Math.round(100*(1-a.c3y/l))/100:1,p="hsl"!==r?"hsva":"hsla";this.color=new pe(`${p}(${h},${u}%,${d}%,${g})`,r),this.controlPositions.c1x=o,this.controlPositions.c1y=n,this.setColorAppearence(),this.updateInputs(),this.updateControls(),this.updateVisuals()}changeControl2(e){const{format:t,width1:o,height1:n,height2:r,height3:a,controlPositions:i}=this;let s=0;e>r?s=r:e>=0&&(s=e);const l="hsl"!==t?Math.round(s/r*360):Math.round(i.c1x/o*360),c="hsl"!==t?Math.round(i.c1x/o*100):Math.round(100*(1-s/r)),h=Math.round(100*(1-i.c1y/n)),u="hex"!==t?Math.round(100*(1-i.c3y/a))/100:1,d="hsl"!==t?"hsva":"hsla";this.color=new pe(`${d}(${l},${c}%,${h}%,${u})`,t),this.controlPositions.c2y=s,this.setColorAppearence(),this.updateInputs(),this.updateControls(),this.updateVisuals()}changeAlpha(e){const{height3:t}=this;let o=0;e>t?o=t:e>=0&&(o=e);const n=Math.round(100*(1-o/t));this.color.setAlpha(n/100),this.controlPositions.c3y=o,this.updateInputs(),this.updateControls()}updateDropdownPosition(){const{input:e,colorPicker:t,colorMenu:o}=this,n=y(e),{offsetHeight:r}=e,a=document.documentElement.clientHeight,i=R(t,"show")?t:o,{offsetHeight:s}=i,l=a-n.bottom,c=n.top,h=n.top+s+r>a,u=n.top-s<0;(R(i,"bottom")||!u)&&l<c&&h?(F(i,"bottom"),T(i,"top")):(F(i,"top"),T(i,"bottom"))}setControlPositions(){const e=this,{hsv:t,hsl:o,format:n,height1:r,height2:a,height3:i,width1:s}=e,l=o.h,c="hsl"!==n?t.s:o.s,h="hsl"!==n?t.v:o.l,u=t.a;e.controlPositions.c1x="hsl"!==n?c*s:l/360*s,e.controlPositions.c1y=(1-h)*r,e.controlPositions.c2y="hsl"!==n?l/360*a:(1-c)*a,"hex"!==n&&(e.controlPositions.c3y=(1-u)*i)}setColorAppearence(){const{componentLabels:e,colorLabels:t,color:o,hsl:n,hsv:r,hex:a,format:i,controlKnobs:s}=this,{appearanceLabel:l,hexLabel:c,valueLabel:h}=e,{r:u,g:d,b:g}=o.toRgb(),[p,b,m]=s,f=Math.round(n.h),w=r.a,v="hsl"===i?n.s:r.s,x=Math.round(100*v),y=Math.round(100*n.l),k=100*r.v;let S;if(100===y&&0===x)S=t.white;else if(0===y)S=t.black;else if(0===x)S=t.grey;else if(f<15||f>=345)S=t.red;else if(f>=15&&f<45)S=k>80&&x>80?t.orange:t.brown;else if(f>=45&&f<75){const e=f>=54&&f<75&&k<80;S=f>46&&f<54&&k<80&&x>90?t.gold:t.yellow,S=e?t.olive:S}else f>=75&&f<155?S=k<68?t.green:t.lime:f>=155&&f<175?S=t.teal:f>=175&&f<195?S=t.cyan:f>=195&&f<255?S=t.blue:f>=255&&f<270?S=t.violet:f>=270&&f<295?S=t.magenta:f>=295&&f<345&&(S=t.pink);let C=`${c} ${a.split("").join(" ")}`;if("hsl"===i?(C=`HSL: ${f}, ${x}%, ${y}%`,D(p,"aria-description",`${h}: ${C}. ${l}: ${S}.`),D(p,"aria-valuetext",`${f}° & ${y}%`),D(p,"aria-valuenow",""+f),D(b,"aria-valuetext",x+"%"),D(b,"aria-valuenow",""+x)):(D(p,"aria-valuetext",`${y}% & ${x}%`),D(p,"aria-valuenow",""+y),D(b,"aria-valuetext",f+"°"),D(b,"aria-valuenow",""+f),C="rgb"===i?`RGB: ${u}, ${d}, ${g}`:C,D(b,"aria-description",`${h}: ${C}. ${l}: ${S}.`)),"hex"!==i){const e=Math.round(100*w);D(m,"aria-valuetext",e+"%"),D(m,"aria-valuenow",""+e)}}updateControls(){const{format:e,controlKnobs:t,controlPositions:o}=this,[n,r,a]=t;n.style.transform=`translate3d(${o.c1x-3}px,${o.c1y-3}px,0)`,r.style.transform=`translate3d(0,${o.c2y-3}px,0)`,"hex"!==e&&(a.style.transform=`translate3d(0,${o.c3y-3}px,0)`)}updateInputs(e){const t=this,{value:o,rgb:n,hsl:r,hsv:a,format:i,parent:s,input:l,inputs:c}=t,[h,u,d,g]=c,p=r.a,b=Math.round(r.h),m=Math.round(100*r.s),f="hsl"===i?r.l:a.v,w=Math.round(100*f);let v;"hex"===i?(v=t.color.toHexString(),h.value=t.hex):"hsl"===i?(v=t.color.toHslString(),h.value=""+b,u.value=""+m,d.value=""+w,g.value=""+p):"rgb"===i&&(v=t.color.toRgbString(),h.value=""+n.r,u.value=""+n.g,d.value=""+n.b,g.value=""+p),t.value=""+v,L(l.style,{backgroundColor:v}),t.isDark?(R(s,"light")&&F(s,"light"),R(s,"dark")||T(s,"dark")):(R(s,"dark")&&F(s,"dark"),R(s,"light")||T(s,"light")),e||v===o||ve(t)}keyHandler(e){const t=this,{menuToggle:o}=t,{activeElement:n}=document,{code:r}=e;[l,c].includes(r)&&(o&&n===o||!n)&&(e.preventDefault(),n?t.toggleMenu():t.togglePicker(e))}togglePicker(e){e.preventDefault();const t=this,{colorPicker:o}=t;t.isOpen&&R(o,"show")?t.hide(!0):ye(t,o)}showPicker(){ye(this,this.colorPicker),O(this.input,"tabindex")}toggleMenu(){const e=this,{colorMenu:t}=e;e.isOpen&&R(t,"show")?e.hide(!0):ye(e,t)}show(){const e=this;e.isOpen||(we(e,!0),e.updateDropdownPosition(),e.isOpen=!0)}hide(e){const t=this;if(t.isOpen){const{pickerToggle:o,menuToggle:n,colorPicker:r,colorMenu:a,parent:i,input:s}=t,l=R(r,"show"),c=l?r:a,h=l?o:n,u=function(e){const t=k(e,"transitionProperty"),o=k(e,"transitionDuration"),n=o.includes("ms")?1:1e3,r=t&&"none"!==t?parseFloat(o)*n:0;return Number.isNaN(r)?0:r}(c);c&&(F(c,"show"),D(h,"aria-expanded","false"),setTimeout(()=>{xe(c),M(".show",i)||(F(i,"open"),we(t),t.isOpen=!1)},u)),l&&D(s,"tabindex","-1"),t.isValid||(t.value=t.color.toString()),e||o.focus()}}dispose(){const{input:e,parent:t}=this;this.hide(!0),fe(this),[...t.children].forEach(t=>{t!==e&&t.remove()}),A(e,{backgroundColor:""}),["light","dark"].forEach(e=>F(t,e)),H.remove(e,"color-picker")}}return L(ke,{Color:pe,Version:"0.0.1alpha2",getInstance:be,init:e=>new ke(e),selector:'[data-function="color-picker"]'}),ke}));
